{"title":"SSL 客户端认证","content":"{\"type\":\"doc\",\"content\":[{\"type\":\"heading\",\"attrs\":{\"level\":2,\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"背景\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"源起于家人在学信网进行学历认证时，发现在使用 Safari 打开认证网页时——页面网址：https://xlrz.chsi.com.cn/wssq/，竟然要先输入密码才能打开页面。大为震惊，完全不知这是什么操作，还以为是新型的黑客手段竟然能在打开网页时窃取密码。\"}]},{\"type\":\"image\",\"attrs\":{\"src\":\"data/articles/ssl-client/files/1731470187062-Pasted Graphic.png\",\"ratio\":null,\"width\":null,\"align\":\"center\",\"href\":null},\"content\":[{\"type\":\"plain_text\",\"content\":[{\"type\":\"text\",\"text\":\"学信网拉起密码验证。\"}]}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"在 Safari 无痕模式下再次打开页面，发现在首次打开页面时，会先弹窗提示要客户端证书，点击继续后才会弹出用户名和密码弹窗。而再次打开时，则不会提示，会直接弹出用户名和密码输入。\"}]},{\"type\":\"image\",\"attrs\":{\"src\":\"data/articles/ssl-client/files/1731470399605-image.png\",\"ratio\":null,\"width\":599.3671875,\"align\":\"center\",\"href\":null},\"content\":[{\"type\":\"plain_text\",\"content\":[{\"type\":\"text\",\"text\":\"首次打开页面提示要求客户端证书\"}]}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"再次尝试使用 Chrome 打开页面，提示选择证书进行身份认证，点击确认会弹窗要输入用户名和密码，点击取消则和 Safari 一样会重定向到一个正常的登录网页。\"}]},{\"type\":\"image\",\"attrs\":{\"src\":\"data/articles/ssl-client/files/1731470534026-image.png\",\"ratio\":null,\"width\":587.4296875,\"align\":\"center\",\"href\":null},\"content\":[{\"type\":\"plain_text\",\"content\":[{\"type\":\"text\",\"text\":\"Chrome 打开页面提示证书认证\"}]}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}},{\"type\":\"heading\",\"attrs\":{\"level\":2,\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"探索\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"经过这一番实验，基本上可以确认，这应该不是黑客手段，而是一种我还不了解的认证或者说登录方式。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"我首先尝试抓包，想了解一下这种认证方式是如何调用的——我理解应该是通过 Javascript 等方式来调用认证的。然而使用 Chrome Devtools 的 network 可以看到，第一个请求还没有返回，选择证书的弹窗就已经弹出了，从这一点来看显然不是 Javascript 的调用，也不会是 HTML。而从 Network 中也可以看到没有 response headers 返回，所以自然也不是 headers 的原因。\"}]},{\"type\":\"image\",\"attrs\":{\"src\":\"data/articles/ssl-client/files/1731471063431-image.png\",\"ratio\":null,\"width\":null,\"align\":\"center\",\"href\":null},\"content\":[{\"type\":\"plain_text\",\"content\":[{\"type\":\"text\",\"text\":\"Chrome Devtools 抓包结果\"}]}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"没有头绪之下，使用相关的关键词 Google 了一下，果然找到了一些结果 —— \"},{\"type\":\"text\",\"marks\":[{\"type\":\"link\",\"attrs\":{\"href\":\"https://www.ssl.com/zh-CN/%E6%96%87%E7%AB%A0%EF%BC%8C/SSL-%E6%8C%87%E5%8D%97-tls-%E4%BB%A5%E5%8F%8A%E5%AE%B9%E5%99%A8%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E8%AF%81%E4%B9%A6/\"}}],\"text\":\"SSL 指南/TLS 容器和客户端身份验证证书\"},{\"type\":\"text\",\"text\":\" 。从文章来看，这里是 SSL 证书的功能。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"简单来说，就是给每一个要访问服务端的客户端分发一个由 CA 签名的客户端证书，然后客户端访问时，在 TLS 握手阶段要客户端提供客户端证书进行验证。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"那为什么学信网的这个申请页面需要客户端认证呢？这个客户端证书又要从哪里下载呢？答案是不知道，不知道啊\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}}]}","createdAt":"2024-11-13T03:49:33.885Z","updatedAt":"2024-11-13T04:34:44.147Z","iv":"","encrypted":false}