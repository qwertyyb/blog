{"title":"浏览器 Dialog 施法指南","content":"{\"type\":\"doc\",\"content\":[{\"type\":\"heading\",\"attrs\":{\"level\":2,\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"背景\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"如果在 Web 上自行实现弹窗，层级是一个避不过的问题。为了把弹窗的层级放在页面上所有的 DOM 之上，一般会采用把 DOM 提到 body 下作为 body 的直接子元素，然后再动态计算当前的 z-index 以确保当前的弹窗能覆盖页面上的元素（据我所知，element-ui 的弹窗层级默认情况下就是动态计算的）。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}},{\"type\":\"heading\",\"attrs\":{\"level\":2,\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Dialog\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"针对上面的情况，浏览器的 Dialog 元素提供了更优雅的解决方案，首先它无须把 DOM 提到下面的 body 下面即可在显示时直接覆盖页面的元素，其次它也不需要计算 z-index，当显示为模态框时（showModal），它的层级高于页面上所有的其它元素。它的层级是由浏览器管理的，称之为 top layer，可以在 Chrome 的开发者工具中看到 dialog 元素的层级如下：\"}]},{\"type\":\"image\",\"attrs\":{\"src\":\"data/articles/html-dialog-top-layer/files/1729260376140-image.png\",\"ratio\":null,\"width\":830.00732421875,\"align\":\"center\",\"href\":null},\"content\":[{\"type\":\"plain_text\",\"content\":[{\"type\":\"text\",\"text\":\"dialog 的 top layer 层级\"}]}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"top layer 层级是由浏览器管理的，开发者是没有办法控制的，上面的top layer 后面的 1 是指这是 top layer 的第一个元素，如果在 dialog 中再次打开 dialog，那第二次打开的弹窗的 dialog 的 top layer 是 2，top layer 值比较大的会覆盖值比较小的元素。这样就可以实现弹窗中弹窗的情景。\"}]},{\"type\":\"image\",\"attrs\":{\"src\":\"data/articles/html-dialog-top-layer/files/1729260878552-image.png\",\"ratio\":null,\"width\":776.795166015625,\"align\":\"center\",\"href\":null},\"content\":[{\"type\":\"plain_text\",\"content\":[{\"type\":\"text\",\"text\":\"弹窗内打开弹窗时的 top layer\"}]}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"top layer 并不是直接应用在 dialog 元素上，而是应用在 \"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"::backdrop\"},{\"type\":\"text\",\"text\":\" 元素上，这也是为什么只有在调用 \"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"showModal\"},{\"type\":\"text\",\"text\":\" 时才能看到 top layer 的原因。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}},{\"type\":\"heading\",\"attrs\":{\"level\":2,\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Top Layer\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"同理 \"},{\"type\":\"text\",\"marks\":[{\"type\":\"link\",\"attrs\":{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/showPopover\"}}],\"text\":\"HTMLElement.showPopover\"},{\"type\":\"text\",\"text\":\" 因为也有 \"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"::backdrop\"},{\"type\":\"text\",\"text\":\" 元素，所以它也是具有 top layer 层级的。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"除了上述两个 API 之外（\"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"HTMLDialogElement.showModal\"},{\"type\":\"text\",\"text\":\"、\"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"HTMLElement.showPopover\"},{\"type\":\"text\",\"text\":\")，\"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"HTMLElement.requestFullscreen\"},{\"type\":\"text\",\"text\":\" 之后的全屏元素也是 top layer 层级的，所以如果要在全屏的界面上显示元素，只能使用 \"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"dialog\"},{\"type\":\"text\",\"text\":\" 元素或 \"},{\"type\":\"text\",\"marks\":[{\"type\":\"code\"}],\"text\":\"showPopover\"},{\"type\":\"text\",\"text\":\" 的方式覆盖。\"}]},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}},{\"type\":\"paragraph\",\"attrs\":{\"align\":\"left\"}}]}","createdAt":"2024-10-18T13:52:51.776Z","updatedAt":"2024-10-18T14:25:13.038Z"}